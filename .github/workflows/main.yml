#this is a basic workflow to help ypu get started with actions

name: CI

#controls when the action will run
on:
  #triggers the workflow on push or pull request but only for the main branch
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  #allows you to run workflow manually from actions tab
  workflow_dispatch:

#a workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  #this workflow contains a single job called "build"
  build:
    #type of runner that job will run on
    runs-on: ubuntu-latest
    #steps represent a sequence of tasks that will be executed as part of the job
    steps:
      #checksout your repository under $GITHUB_WORKSPACE, so your job can access it
      - uses: actions/checkout@v2
      
      - name: PerfAction for JMeter
      # You may pin to the exact commit or the version.
      # uses: QAInsights/PerfAction@2c22274f313e13ce9ddaf60c9f337a0e628fcb9d
        uses: QAInsights/PerfAction@2.0
        with:
          # JMeter test plan to execute
          test-plan-path: './jmeter.jmx'

      - name: Upload Results
        uses: actions/upload-artifact@v3
        with:
          name: jmeter-results
          path: result.jtl
          if-no-files-found: error
